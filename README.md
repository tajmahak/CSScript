## Установка

1. Распаковать утилиту в постоянную папку (например: "C:\CSScript\");
2. Запустить "register.bat" для регистрации утилиты в реестре.

Для проверки работоспособности можно запустить "HelloWorld.cssc".
Перед удалением утилиты запустить "unregister.bat" для очистки информации из реестра.

## Описание

```
Утилита для выполнения C# скриптов.

Параметры командной строки для запуска скрипта:

 [путь к файлу скрипта]

 [-h]
   - (hide) выполнение скрипта в скрытом режиме;

 [-p]
   - (pause) после окончания работы скрипта ожидать от пользователя подтверждение закрытия;

 [-a] {...}
   - (args) входящие параметры для использования в скрипте (args: string[]);

 Дополнительные параметры:

  [-reg]
    - регистрация расширения .cssc в реестре;

  [-unreg]
    - удаление расширения .cssc из реестра;


Служебный синтаксис скрипта:

 #using {...}
   - конструкция C# using. Используется # в начале строки;

 #import {...}
   - подключение другого скрипта или сборки Windows (*.exe, *.dll);

 #class
   - обозначение начала области внутри класса;

 #ns/#namespace
   - обозначение начала области внутри пространства имён;


Взаимодействие с контекстом:

 Context: IScriptContext
   - реализация интерфейса для взаимодействия скрипта с контекстом:

  .Args: string[]
    - получает входящие аргументы командной строки;

  .ExitCode: int
    - получает или задаёт код возврата скрипта;

  .Pause: bool
    - получает или задаёт значение, следует ли ожидать от пользователя подтверждение закрытия;

  .ScriptPath: string
    - получает абсолютный путь к исполняемому скрипту;

  .OutLog: IList<LogFragment>
    - получает лог работы скрипта (стандартный выходной поток);

  .ErrorLog: IList<LogFragment>
    - получает лог работы скрипта (стандартный поток ошибок);

  .Write(value: object, [color: ConsoleColor]): void
    - вывод сообщения в лог;

  .WriteLine([value: object], [color: ConsoleColor]): void
    - вывод сообщения в лог с переносом строки;

  .WriteError(value: object): void
    - вывод сообщения в лог ошибок;

  .WriteErrorLine([value: object]): void
    - вывод сообщения в лог ошибок с переносом строки;

  .ReadLine([caption: string], [color: ConsoleColor]): string
    - чтение текста из входного потока;

  .RegisterProcess(process: Process): void
    - регистрация созданного процесса для автозакрытия в случае ошибки в работе скрипта;

 Colors: ColorScheme
   - получает цвета для использования в консоли (аналог Context.ColorScheme);

  .Foreground
    - цвет основного текста;

  .Caption
    - цвет заголовка;

  .Info
    - цвет информационного текста;

  .Success
    - цвет сообщения об успешной операции;

  .Error
    - цвет сообщения об ошибке;


Пример скрипта:

 // Выполнение кода в основной области (внутри процедуры)
 PrintHelloWorld();

 // Начало области внутри класса
 #class

 void PrintHelloWorld() {
     string scriptName = Path.GetFileName(Context.ScriptPath);
     Context.WriteLine("Hello World from " + scriptName, Colors.Caption);
 }

 // Директиву using допустимо использовать в любой части скрипта
 #using System.IO;
```
